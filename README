Just some notes on how MDS scrambling order and validity is determined in the annotation of the XML database.

Maps are marked invalid on a MAC contig-by-contig basis, so if there are some individual maps for a MAC contig that would individually be considered valid, they are treated as invalid if not _all_ maps for that contig are valid.

MAC contigs are considered invalid if they are not fully covered by MDS annotations or if they contain overlapping MDS, i.e. you have bases 65-164 of the contig covered by an MDS from one MIC contig, then bases 1-158 covered by an MDS from a different MIC contig. For the current annotation, I chose arbitrary values of 50 for the maximum number of bases that could go uncovered between two MDS (or the first/last MDS and the end of the contig) and 80% overlap between two MDS to call a contig invalid. These values can be changed by specifying the "--coverage_cutoff" and "--overlap_cutoff" parameters for annotate_xml_maps.py.

Also, for the purposes of determining how much of the MAC contig was covered, I used the telomere-less length of each contig based on the final MAC assembly and Estienne's alternative fragmentation data, which lists every telomere addition site for each contig. There are some instances where a contig has internal telomere addition sites (alternative fragmentation) but no telomeres on the end, so for the purpose of determining contig length I excluded all telomeres >100bp from either end of the contig. Also, the telomeres were defined to be the most 3' and most 5' telomere addition sites, respectively.

While validity was determined on the level of MAC contigs, scrambling was determined at the level of individual maps. A map may have a scrambling annotation even if it was not considered valid. This is because there are many MAC contigs that come from multiple MIC loci where the global scrambling pattern would have to be determined arbitrary (i.e. which MIC contig should be said to have the "first" MDS?), but where the scrambling within a map can easily be determined. Scrambling considers the order of contigs only, not their orientation; therefore, if a contig has its MDS in canonical order, but one is inverted, it should not be called scrambled.

Finally, I also added a "multi-locus" annotation to maps where the MAC contig comes from more than one MIC contig and therefore has several associated maps. This identifier is applied at the contig level, thus, to all maps for that MAC contig.
